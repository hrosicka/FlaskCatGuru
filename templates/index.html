<!DOCTYPE html>
<html lang="cs">
<head>
    <title>Cat Guru</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='style.css') }}">
</head>
<body style="background-color: {{ background_color }};">
    <main class="main-container">
        <div class="container">
            <img id="avatar" src="{{ url_for('static', filename=avatar.split('static/')[1]) }}" alt="Cat Avatar">
            <div id="wisdom" class="wisdom-text"></div>
            <div class="options">
                <button id="wisdomButton">Ask the Cat Guru</button>
                <button id="avatarButton">Change Avatar</button>
                <button id="backgroundButton">Change Background</button>
            </div>
        </div>
    </main>
    <script>
        const avatar = document.getElementById('avatar');
        const wisdom = document.getElementById('wisdom');
        const wisdomButton = document.getElementById('wisdomButton');
        const avatarButton = document.getElementById('avatarButton');
        const backgroundButton = document.getElementById('backgroundButton');
        let backgroundColor = "{{ background_color }}";
        let currentAvatar = "{{ avatar }}";

        wisdomButton.addEventListener('click', () => {
            fetch('/wisdom')
                .then(response => response.json())
                .then(data => {
                    wisdom.innerText = data.wisdom;
                });
        });

        avatarButton.addEventListener('click', () => {
            fetch('/change_avatar', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ current_avatar: currentAvatar })
            })
                .then(response => response.json())
                .then(data => {
                    avatar.src = "{{ url_for('static', filename='') }}" + data.new_avatar.split('static/')[1];
                    currentAvatar = data.new_avatar;
                });
        });

        backgroundButton.addEventListener('click', () => {
            fetch('/change_background', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ current_color: backgroundColor })
            })
                .then(response => response.json())
                .then(data => {
                    document.body.style.backgroundColor = data.new_color;
                    backgroundColor = data.new_color;
                });
        });
    </script>
</body>
</html>